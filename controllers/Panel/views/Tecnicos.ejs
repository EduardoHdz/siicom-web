<!DOCTYPE html>
<html lang="es">
<head>
<% include ../views/Secciones/head %>
	<title><%=title%></title>
	<% include ../views/Secciones/header %>
  <script>
      window.onload = function() {
        window.addEventListener('mousemove', function(){$('.footable').footable()});
      };
    </script>
</head>
<body>
<% include ../views/Secciones/menu %>
<div class="col-sm-9 col-sm-offset-3 col-lg-10 col-lg-offset-2 main">

   <div  class="contact-box center-version">
    <div class="row">
			<div class="col-sm-12">
        <h1 class="page-header">Información de técnicos</h1>
      </div>

      <div class="col-sm-12">
				 <div class="title-action">
                <button type="button" style="margin-left: 1%; margin-bottom: 2%;" class="btn btn-primary" data-toggle="modal" data-target="#addTechnical">Nuevo Técnico</button>
            </div>
			</div>
		</div><!--/.row-->
    </div>

      <!--AGREGAR TÉCNICO-->
        <div class="modal inmodal" id="addTechnical" tabindex="-1" role="dialog" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content animated bounceIn">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">Agregar nuevo Técnico</h4>
              </div>
               <div class="modal-body">
                 <form action="/technical" method="post" name="info_form">
                     <div class="modal-body clearfix">
                         <div class="controls">
                             <div class="form-group">
                                 <label for="Nombre">Nombre</label>
                                  <input type="text" class="form-control" id="Nombre" name="Nombre" placeholder="Nombre" required="" >
                              </div>
                              <div class="form-group">
                                 <label for="Email">Email</label>
                                  <input type="email" class="form-control" id="Email" name="Email" placeholder="example@example.com" required="" >
                              </div>
                               <div class="form-group">
                                 <label for="Nombre">Password</label>
                                  <input type="password" class="form-control" id="Password" name="Password" placeholder="Password" required="" >
                              </div>
                              <div class="form-group">
                                  <label for="Tel">Tel</label>
                                  <input type="text" class="form-control" id="Tel" data-mask="(999) 999-9999" name="Tel" placeholder="Télefono" required="" >
                              </div>
                              <div class="form-group">
                                  <label for="ID-Nextel">ID-Nextel</label>
                                 <input type="text" class="form-control" id="ID-Nextel" data-mask="99-999999-9" name="IDNextel" placeholder="ID-Nextel" required="" >
                              </div>

                              <div class="form-group">
                                  <label for="Puesto">Puesto</label>
                                 <input type="text" class="form-control" id="Puesto" name="Puesto" placeholder="Puesto" required="" >
                              </div>

                              <div class="form-group">
                                  <label for="UL">Nivel de usuario</label>
                                 <SELECT class="form-control" id="UL" name="userLvl" required="">
                                  <option value="">Seleccione..</option>
                                  <option value="0"> Estandar </option>
                                  <option value="1"> Administrador </option>
                                  </SELECT> 
                              </div>
                          </div>
                      </div>
                      <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Agregar</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>


        <!--ACTUALIZAR TÉCNICO-->
        <div class="modal inmodal" id="editClient" tabindex="-1" role="dialog" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content animated bounceIn">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title">Actualizar técnico</h4>
              </div>
               <div class="modal-body">
                 <form action="/upTech" method="post" name="info_form">
                     <div class="modal-body clearfix">
                         <div class="controls">
                             <div class="form-group">
                                 <label for="Nombre">Nombre</label>
                                  <input type="text" class="form-control" id="Nombre1" name="Nombre" placeholder="Nombre" required="" >
                              </div>
                              <div class="form-group">
                                 <label for="Email">Email</label>
                                  <input type="email" class="form-control" id="Email1" name="Email" placeholder="example@example.com" required="" >
                              </div>
                              <div class="form-group">
                                  <label for="Tel">Tel</label>
                                  <input type="text" class="form-control" id="Tel1" data-mask="(999) 999-9999" name="Tel" placeholder="Télefono" required="" >
                              </div>
                              <div class="form-group">
                                  <label for="ID-Nextel">ID-Nextel</label>
                                 <input type="text" class="form-control" id="ID-Nextel1" data-mask="99-999999-9" name="IDNextel" placeholder="ID-Nextel" required="" >
                              </div>

                              <div class="form-group">
                                  <label for="Puesto">Puesto</label>
                                 <input type="text" class="form-control" id="Puesto1" name="Puesto" placeholder="Puesto" required="" >
                              </div>

                              <div class="form-group">
                                  <label for="UL1">Nivel de usuario</label>
                                 <SELECT class="form-control" id="UL1" name="userLvl1" required="">
                                  <option value="">Seleccione..</option>
                                  <option value="0"> Estandar </option>
                                  <option value="1"> Administrador </option>
                                  </SELECT> 
                              </div>
                              <input type="hidden" class="form-control" id="id" name="idTécnico" required="" >
                          </div>
                      </div>
                      <div class="modal-footer">
                    <button type="submit" class="btn btn-primary">Actualizar</button>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>


    <div class="ibox-content" id="informacion">
          <div class="scroll">
            <input type="text" class="form-control input-sm m-b-xs" id="filter" placeholder="Buscar ...">
              <table class="footable table table-stripped" data-filter="#filter" data-page-size="" id="informacion">
                <thead>
                  <tr>

                   <th nowrap>ID Técnico</th>
                   <th nowrap>Nombre</th>
                   <th nowrap>Email</th>
                   <th nowrap>Teléfono</th>
                   <th nowrap>ID-Nextel</th>
                   <th nowrap>Puesto</th>
                   <th nowrap>Opciones</th>
                  </tr>

                </thead>
                <tbody class="Table">

                </tbody>
                <tfoot>
                  <tr>
                    <td colspan="11">
                      <ul class="pagination pull-right"></ul>
                    </td>
                  </tr>
                </tfoot>
              </table>
            </div>
     </div>
     <div class="row">
     <div class="col-lg-3">
                <div class="contact-box center-version">

                    <a href="profile.html">

                        <img alt="image" class="img-circle" src="img/a2.jpg">


                        <h3 class="m-b-xs"><strong>John Smith</strong></h3>

                        <div class="font-bold">Graphics designer</div>
                        <address class="m-t-md">
                            <strong>Twitter, Inc.</strong><br>
                            795 Folsom Ave, Suite 600<br>
                            San Francisco, CA 94107<br>
                            <abbr title="Phone">P:</abbr> (123) 456-7890
                        </address>

                    </a>
                    <div class="contact-box-footer">
                        <div class="m-t-xs btn-group">
                            <a class="btn btn-xs btn-white"><i class="fa fa-phone"></i> Call </a>
                            <a class="btn btn-xs btn-white"><i class="fa fa-envelope"></i> Email</a>
                            <a class="btn btn-xs btn-white"><i class="fa fa-user-plus"></i> Follow</a>
                        </div>
                    </div>

                </div>

  </div>

</div>



	<% include ../views/Secciones/footer %>
	<script>


  function editarT(id) {
         $('#editClient').modal();
         $.ajax({
             url: "/editTech/" + id + "",
             type: "GET",
             success: function (result) {
                 $('#Nombre1').val(result[0].Nombre);
                 $('#Email1').val(result[0].Email);
                 $('#Tel1').val(result[0].Tel);
                 $('#ID-Nextel1').val(result[0].IDNextel);
                 $('#Puesto1').val(result[0].Puesto);
                 $('#UL1').val(result[0].userLvl);
                 $('#id').val(result[0].idTécnico);
             }, error: function (result) {

             }

         });
     }



      function delTech(id) {
        swal({
            title: "¿Estás seguro?",
            text: "¡No podrás recuperar el registro!",
            type: "warning",
            showCancelButton: true,
            confirmButtonColor: "#DD6B55",
            confirmButtonText: "Si, dale cuello!",
            closeOnConfirm: false
          }, function () {
                swal("Eliminado!", "El registro ha sido eliminado.", "success", setTimeout(function() { 
                 $.ajax({
                     url: "/delTech/" + id + "",
                     type: "GET",
                     success: function (result) {
                        if(result = "done"){
                          location.reload();
                        }else{
                          alert("Ocurrio un error: "+ result);
                        }
                     }, error: function (result) {
                        alert(result);
                     }
                   });
                 }, 1200));
             });
             }

     function correo(mail) {
          var to=mail;      
            //alert("Enviando Email... porfavor espere.");
             $.ajax({
             url: "/send/" + to + "",
             type: "GET",
             success: function (result) {
                if(result=="sent")
            {
              swal("El mensaje se ha sido enviado.", "la contraseña fue enviada a "+to+".", "success", setTimeout(function() { 
                }, 1200));
            }
             }, error: function (result) {
                alert(result);
             }

         });
      }

		$(document).ready(function(){
			$("#item3").addClass("active");

				$.ajax({
				url: "/infoTech",
				Type: "GET",
				success: function(result){
					if(result==0){
			        }else{

			          for (var i = 0; i <= result.length; i++) {
			          	var row = $("<tr>")
			            $('.Table').append(row); 
			            row.append($("<td>" + result[i].idTécnico + "</td>"));
                  row.append($("<td>" + result[i].Nombre + "</td>"));
                  row.append($("<td>" + result[i].Email + "</td>"));
			            row.append($("<td>"+ result[i].Tel + "</td>"));
			            row.append($("<td>"+ result[i].IDNextel + "</td>"));
                  row.append($("<td>"+ result[i].Puesto + "</td>"));
			            row.append($("<td >" + "<button onclick=correo("+'"'+result[i].Email+'"'+") class='widget-icon'><i class='fa fa-send text-navy'></i></button>" +" &nbsp; " + "<button onclick=editarT("+result[i].idTécnico+") class='widget-icon'><i class='fa fa-edit text-navy'></i></button>" + " &nbsp; " + "<button class='widget-icon' onclick=delTech("+result[i].idTécnico+")><i class='fa fa-trash text-navy'></i></button>" + "</td>"));
			            $('.footable').attr("data-page-size","5");
                  }
			        }
		        }
		    });
		});
</script>		
</body>
</html>